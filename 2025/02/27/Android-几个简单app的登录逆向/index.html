<!DOCTYPE html><html lang="zh_CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Android-几个简单app的登录逆向 | 摆烂小子</title><meta name="author" content="摆烂小子"><meta name="copyright" content="摆烂小子"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="几个简单app的登录逆向以下app都是来自小肩膀2022安卓逆向课程的案例。 一、今日镇江1、升级弹窗去除打开弹出升级框，不想升级所以直接给他干掉。  两种方法： 1、找到获取版本的地方，hook改变返回值使得本地app版本和远程服务器app版本一致，经过比对后就不会弹出该提示框。 2、直接找到弹框部分，给该部分直接用hook给nop掉。 这里直接使用第二种方法。 这个app没有字符串加密，所有首">
<meta property="og:type" content="article">
<meta property="og:title" content="Android-几个简单app的登录逆向">
<meta property="og:url" content="https://bailan2.github.io/2025/02/27/Android-%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95app%E7%9A%84%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91/index.html">
<meta property="og:site_name" content="摆烂小子">
<meta property="og:description" content="几个简单app的登录逆向以下app都是来自小肩膀2022安卓逆向课程的案例。 一、今日镇江1、升级弹窗去除打开弹出升级框，不想升级所以直接给他干掉。  两种方法： 1、找到获取版本的地方，hook改变返回值使得本地app版本和远程服务器app版本一致，经过比对后就不会弹出该提示框。 2、直接找到弹框部分，给该部分直接用hook给nop掉。 这里直接使用第二种方法。 这个app没有字符串加密，所有首">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bailan2.github.io/img/android.png">
<meta property="article:published_time" content="2025-02-27T06:39:49.000Z">
<meta property="article:modified_time" content="2025-03-04T12:50:36.113Z">
<meta property="article:author" content="摆烂小子">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bailan2.github.io/img/android.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://bailan2.github.io/2025/02/27/Android-%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95app%E7%9A%84%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: 摆烂小子","link":"Link: ","source":"Source: 摆烂小子","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Android-几个简单app的登录逆向',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-04 20:50:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/title.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/android.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">摆烂小子</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Android-几个简单app的登录逆向</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-02-27T06:39:49.000Z" title="Created 2025-02-27 14:39:49">2025-02-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-04T12:50:36.113Z" title="Updated 2025-03-04 20:50:36">2025-03-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Android%E9%80%86%E5%90%91/">Android逆向</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">5.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>26min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Android-几个简单app的登录逆向"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="几个简单app的登录逆向"><a href="#几个简单app的登录逆向" class="headerlink" title="几个简单app的登录逆向"></a>几个简单app的登录逆向</h1><p>以下app都是来自小肩膀2022安卓逆向课程的案例。</p>
<h2 id="一、今日镇江"><a href="#一、今日镇江" class="headerlink" title="一、今日镇江"></a>一、今日镇江</h2><h3 id="1、升级弹窗去除"><a href="#1、升级弹窗去除" class="headerlink" title="1、升级弹窗去除"></a>1、升级弹窗去除</h3><p>打开弹出升级框，不想升级所以直接给他干掉。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE3oShV"><img src="https://s21.ax1x.com/2025/02/27/pE3oShV.png" alt="pE3oShV.png" style="zoom:67%;" /></a></p>
<p>两种方法：</p>
<p>1、找到获取版本的地方，hook改变返回值使得本地app版本和远程服务器app版本一致，经过比对后就不会弹出该提示框。</p>
<p>2、直接找到弹框部分，给该部分直接用hook给nop掉。</p>
<p>这里直接使用第二种方法。</p>
<p>这个app没有字符串加密，所有首先jadx搜索字符串”升级提示”，定位到strings.xml中的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;string name=<span class="string">&quot;update_info&quot;</span>&gt;升级提示&lt;/string&gt;</span><br></pre></td></tr></table></figure>

<p>之后继续搜索<code>update_info</code>找到弹框的部分定位到如下函数，直接frida替换整个函数并且使用spwan模式启动时注入。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE3Ij7n"><img src="https://s21.ax1x.com/2025/02/27/pE3Ij7n.png" alt="pE3Ij7n.png" style="zoom:80%;" /></a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">ActivityUtils</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.cmstop.cloud.base.ActivityUtils&quot;</span>);</span><br><span class="line">    <span class="title class_">ActivityUtils</span>.<span class="property">createUpdateDialog</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">activity</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ActivityUtils is replaced to NULL!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2、登录逆向"><a href="#2、登录逆向" class="headerlink" title="2、登录逆向"></a>2、登录逆向</h3><p>之后分析登录逻辑，没有抓包检测，使用httpcanary抓到如下包：</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE3Izt0"><img src="https://s21.ax1x.com/2025/02/27/pE3Izt0.png" alt="pE3Izt0.png" style="zoom:67%;" /></a></p>
<p>发现只有一个sign是未知的，其余的要么是时间戳，要么是固定的设备id等等。所以分析sign就行了。</p>
<p>同样先用jadx搜索字符串”sign”，定位到</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">MODULE_SIGN</span> <span class="operator">=</span> <span class="string">&quot;sign&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>交叉引用有多个，逐个看一下，最后定位到正确位置，在<code>com.cmstop.cloud.b.b.a</code>函数中：</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE3IX0s"><img src="https://s21.ax1x.com/2025/02/27/pE3IX0s.png" alt="pE3IX0s.png"></a></p>
<p>再步入到<code>m9920</code>中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">m9920a</span><span class="params">(HashMap&lt;String, String&gt; paramsMap, String time)</span> &#123;</span><br><span class="line">        LinkedHashMap&lt;String, String&gt; sortParams = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">        Object[] key_arr = paramsMap.keySet().toArray();</span><br><span class="line">        Arrays.sort(key_arr);</span><br><span class="line">        <span class="keyword">for</span> (Object key : key_arr) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                sortParams.put(key.toString(), URLEncoder.encode(paramsMap.get(key).toString(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : sortParams.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (result.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                result.append(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            result.append(entry.getKey());</span><br><span class="line">            result.append(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">            result.append(entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">replace</span> <span class="operator">=</span> result.toString().replace(<span class="string">&quot;*&quot;</span>, <span class="string">&quot;%2A&quot;</span>).replace(<span class="string">&quot;%7E&quot;</span>, <span class="string">&quot;~&quot;</span>).replace(<span class="string">&quot;+&quot;</span>, <span class="string">&quot;%20&quot;</span>);</span><br><span class="line">        crack.log(replace);</span><br><span class="line">        <span class="type">String</span> <span class="variable">resultMD5</span> <span class="operator">=</span> MD5.md5(replace);</span><br><span class="line">        crack.log(resultMD5);</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> resultMD5 + <span class="string">&quot;1fa50ba25ed527f3fd1eb9467686f2bb&quot;</span> + time;</span><br><span class="line">        crack.log(str);</span><br><span class="line">        <span class="type">String</span> <span class="variable">md5Result</span> <span class="operator">=</span> MD5.md5(str);</span><br><span class="line">        crack.log(md5Result);</span><br><span class="line">        <span class="keyword">return</span> md5Result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>分析可知，sign是两次md5的结果，首先把GET请求中的一些参数排序后了拼接在一起，拼接完成后取md5值，再把第一次的md5和<code>1fa50ba25ed527f3fd1eb9467686f2bb</code>以及时间戳拼接后再次取md5即为最后的sign值。</p>
<h3 id="3、登录协议复现"><a href="#3、登录协议复现" class="headerlink" title="3、登录协议复现"></a>3、登录协议复现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">#timestamp = str(int(time.time() * 1000))</span></span><br><span class="line">timestamp = <span class="string">&quot;1740639186157&quot;</span>  <span class="comment">#这里是为了演示算法自吐，正常模拟登录需使用当前的时间</span></span><br><span class="line">phone = <span class="string">&quot;17860581502&quot;</span>        <span class="comment">#只需替换phone和password</span></span><br><span class="line">password = <span class="string">&quot;123456&quot;</span></span><br><span class="line">data1 = <span class="string">&quot;account=17860581502&amp;clientid=1&amp;device_id=9719046b-4f61-45b5-9201-d7d878588158&amp;ip=100.100.100.100&amp;modules=cloudlogin%3A1&amp;password=123456&amp;siteid=10001&amp;system_name=android&amp;type=android&quot;</span></span><br><span class="line">sign1 = hashlib.md5(data1.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">data2 = sign1 + <span class="string">&quot;1fa50ba25ed527f3fd1eb9467686f2bb&quot;</span> + timestamp</span><br><span class="line">sign2 = hashlib.md5(data2.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(sign2)</span><br><span class="line">url = <span class="string">&quot;http://m.api.zt.jsw.com.cn/v2/member?password=&quot;</span> + password + <span class="string">&quot;&amp;clientid=1&amp;device_id=9719046b-4f61-45b5-9201-d7d878588158&amp;ip=100.100.100.100&amp;system_name=android&amp;sign=&quot;</span> + sign2 +  <span class="string">&quot;&amp;siteid=10001&amp;time=&quot;</span> + timestamp +  <span class="string">&quot;&amp;type=android&amp;account=&quot;</span> + phone + <span class="string">&quot;&amp;modules=cloudlogin%3A1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># headers = &#123;</span></span><br><span class="line"><span class="comment">#     &quot;Content-Length&quot;: &quot;0&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;Host&quot;: &quot;m.api.zt.jsw.com.cn&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;Connection&quot;: &quot;Keep-Alive&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;Accept-Encoding&quot;: &quot;gzip&quot;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line">r = requests.get(url=url)</span><br><span class="line">recv = r.text</span><br><span class="line"><span class="built_in">print</span>(recv)</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment"># 解析 JSON 字符串</span></span><br><span class="line">data = json.loads(recv)     <span class="comment">#这里json能自动把unicode解析成中文。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取 &#x27;error&#x27; 字段的内容</span></span><br><span class="line">error_value = data[<span class="string">&#x27;error&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(error_value)</span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">9aa0acfd26cf5252424c5f8369dbc7c0</span><br><span class="line">&#123;<span class="string">&quot;state&quot;</span>:false,<span class="string">&quot;error&quot;</span>:<span class="string">&quot;\u8d26\u53f7\u6216\u5bc6\u7801\u9519\u8bef&quot;</span>,<span class="string">&quot;info&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">账号或密码错误</span><br></pre></td></tr></table></figure>

<p>与抓包的响应内容一致。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE3Ixkq"><img src="https://s21.ax1x.com/2025/02/27/pE3Ixkq.jpg" alt="pE3Ixkq.jpg" style="zoom: 67%;" /></a></p>
<h3 id="4、算法自吐"><a href="#4、算法自吐" class="headerlink" title="4、算法自吐"></a>4、算法自吐</h3><p>既然是标准md5，那么可以直接算法自吐解决，输出到log.txt后。</p>
<p>首先搜索sign值<code>9aa0acfd26cf5252424c5f8369dbc7c0</code>找到如下信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">MD5 update data Utf8: a3075ce87e36cc6736d92cd8056036301fa50ba25ed527f3fd1eb9467686f2bb1740639186157</span><br><span class="line">MD5 update data Hex: <span class="number">6133303735636538376533366363363733366439326364383035363033363330316661353062613235656435323766336664316562393436373638366632626231373430363339313836313537</span></span><br><span class="line">MD5 update data Base64: YTMwNzVjZTg3ZTM2Y2M2NzM2ZDkyY2Q4MDU2MDM2MzAxZmE1MGJhMjVlZDUyN2YzZmQxZWI5NDY3Njg2ZjJiYjE3NDA2MzkxODYxNTc=</span><br><span class="line">=======================================================</span><br><span class="line">MessageDigest.digest() is called!</span><br><span class="line">java.lang.Throwable</span><br><span class="line">	at java.security.MessageDigest.digest(Native Method)</span><br><span class="line">	at com.cmstopcloud.librarys.utils.MD5.md5(MD5.java:<span class="number">48</span>)</span><br><span class="line">	at com.cmstop.cloud.b.b.a(APIRequestService.java:<span class="number">822</span>)</span><br><span class="line">	at com.cmstop.cloud.b.b.a(APIRequestService.java:<span class="number">840</span>)</span><br><span class="line">	at com.cmstop.cloud.b.b.a(APIRequestService.java:<span class="number">1252</span>)</span><br><span class="line">	at com.cmstop.cloud.activities.LoginCloudActivity.a(LoginCloudActivity.java:<span class="number">141</span>)</span><br><span class="line">	at com.cmstop.cloud.activities.LoginCloudActivity.onClick(LoginCloudActivity.java:<span class="number">65</span>)</span><br><span class="line">	at android.view.View.performClick(View.java:<span class="number">7140</span>)</span><br><span class="line">	at android.view.View.performClickInternal(View.java:<span class="number">7117</span>)</span><br><span class="line">	at android.view.View.access$<span class="number">3500</span>(View.java:<span class="number">801</span>)</span><br><span class="line">	at android.view.View$PerformClick.run(View.java:<span class="number">27351</span>)</span><br><span class="line">	at android.os.Handler.handleCallback(Handler.java:<span class="number">883</span>)</span><br><span class="line">	at android.os.Handler.dispatchMessage(Handler.java:<span class="number">100</span>)</span><br><span class="line">	at android.os.Looper.loop(Looper.java:<span class="number">214</span>)</span><br><span class="line">	at android.app.ActivityThread.main(ActivityThread.java:<span class="number">7356</span>)</span><br><span class="line">	at java.lang.reflect.Method.invoke(Native Method)</span><br><span class="line">	at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:<span class="number">492</span>)</span><br><span class="line">	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="number">930</span>)</span><br><span class="line"></span><br><span class="line">MD5 digest result Hex: 9aa0acfd26cf5252424c5f8369dbc7c0</span><br><span class="line">MD5 digest result Base64: mqCs/SbPUlJCTF+DadvHwA==</span><br></pre></td></tr></table></figure>

<p>发现传入的参数就是<code>sign1 + &quot;1fa50ba25ed527f3fd1eb9467686f2bb&quot; + time</code>，且定位也是我们分析的位置</p>
<p>所以接着搜索<code>sign1:a3075ce87e36cc6736d92cd805603630</code>,找到如下信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">MD5 update data Utf8: account=<span class="number">17860581502</span>&amp;clientid=<span class="number">1</span>&amp;device_id=9719046b-4f61-45b5-<span class="number">9201</span>-d7d878588158&amp;ip=<span class="number">100.100</span><span class="number">.100</span><span class="number">.100</span>&amp;modules=cloudlogin%3A1&amp;password=<span class="number">123456</span>&amp;siteid=<span class="number">10001</span>&amp;system_name=android&amp;type=android</span><br><span class="line">MD5 update data Hex: 6163636f756e743d313738363035383135303226636c69656e7469643d31266465766963655f69643d39373139303436622d346636312d343562352d393230312d6437643837383538383135382669703d3130302e3130302e3130302e313030266d6f64756c65733d636c6f75646c6f67696e253341312670617373776f72643d313233343536267369746569643d31303030312673797374656d5f6e616d653d616e64726f696426747970653d616e64726f6964</span><br><span class="line">MD5 update data Base64: YWNjb3VudD0xNzg2MDU4MTUwMiZjbGllbnRpZD0xJmRldmljZV9pZD05NzE5MDQ2Yi00ZjYxLTQ1YjUtOTIwMS1kN2Q4Nzg1ODgxNTgmaXA9MTAwLjEwMC4xMDAuMTAwJm1vZHVsZXM9Y2xvdWRsb2dpbiUzQTEmcGFzc3dvcmQ9MTIzNDU2JnNpdGVpZD0xMDAwMSZzeXN0ZW1fbmFtZT1hbmRyb2lkJnR5cGU9YW5kcm9pZA==</span><br><span class="line">=======================================================</span><br><span class="line">MessageDigest.digest() is called!</span><br><span class="line">java.lang.Throwable</span><br><span class="line">	at java.security.MessageDigest.digest(Native Method)</span><br><span class="line">	at com.cmstopcloud.librarys.utils.MD5.md5(MD5.java:<span class="number">48</span>)</span><br><span class="line">	at com.cmstop.cloud.b.b.a(APIRequestService.java:<span class="number">815</span>)</span><br><span class="line">	at com.cmstop.cloud.b.b.a(APIRequestService.java:<span class="number">840</span>)</span><br><span class="line">	at com.cmstop.cloud.b.b.a(APIRequestService.java:<span class="number">1252</span>)</span><br><span class="line">	at com.cmstop.cloud.activities.LoginCloudActivity.a(LoginCloudActivity.java:<span class="number">141</span>)</span><br><span class="line">	at com.cmstop.cloud.activities.LoginCloudActivity.onClick(LoginCloudActivity.java:<span class="number">65</span>)</span><br><span class="line">	at android.view.View.performClick(View.java:<span class="number">7140</span>)</span><br><span class="line">	at android.view.View.performClickInternal(View.java:<span class="number">7117</span>)</span><br><span class="line">	at android.view.View.access$<span class="number">3500</span>(View.java:<span class="number">801</span>)</span><br><span class="line">	at android.view.View$PerformClick.run(View.java:<span class="number">27351</span>)</span><br><span class="line">	at android.os.Handler.handleCallback(Handler.java:<span class="number">883</span>)</span><br><span class="line">	at android.os.Handler.dispatchMessage(Handler.java:<span class="number">100</span>)</span><br><span class="line">	at android.os.Looper.loop(Looper.java:<span class="number">214</span>)</span><br><span class="line">	at android.app.ActivityThread.main(ActivityThread.java:<span class="number">7356</span>)</span><br><span class="line">	at java.lang.reflect.Method.invoke(Native Method)</span><br><span class="line">	at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:<span class="number">492</span>)</span><br><span class="line">	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="number">930</span>)</span><br><span class="line"></span><br><span class="line">MD5 digest result Hex: a3075ce87e36cc6736d92cd805603630</span><br><span class="line">MD5 digest result Base64: owdc6H42zGc22SzYBWA2MA==</span><br></pre></td></tr></table></figure>

<p>观察参数发现就是排序后的请求体信息，直接搞定！</p>
<h2 id="二、0715圈"><a href="#二、0715圈" class="headerlink" title="二、0715圈"></a>二、0715圈</h2><h3 id="1、登录逆向"><a href="#1、登录逆向" class="headerlink" title="1、登录逆向"></a>1、登录逆向</h3><p>分析登录逻辑，同样没有抓包检测，使用httpcanary抓到如下包：</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE8uFY9"><img src="https://s21.ax1x.com/2025/02/28/pE8uFY9.png" alt="pE8uFY9.png" style="zoom:67%;" /></a></p>
<p>同样只有一个codeSign是未知的,字符串未加密，jadx直接字符串”codeSign”搜定位到如下函数代码。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE8uCo4"><img src="https://s21.ax1x.com/2025/02/28/pE8uCo4.png" alt="pE8uCo4.png"></a></p>
<p>发现有两个分支，两个分支的codeSign一个走的<code>C6485v.m7977a</code>，另一个走的<code>C6485v.m79778</code>，这俩函数是一个类下的重载函数。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE8uiFJ"><img src="https://s21.ax1x.com/2025/02/28/pE8uiFJ.png" alt="pE8uiFJ.png"></a></p>
<p>那就都hook一下，看具体走的哪个流程。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> v = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.quan0715.forum.util.v&quot;</span>);</span><br><span class="line">v.<span class="property">a</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;com.alibaba.fastjson.JSONObject&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;long&#x27;</span>).<span class="property">implementation</span>= <span class="keyword">function</span> (<span class="params">a,b,c,d</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param1: &quot;</span> + a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param2: &quot;</span> + b);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param3: &quot;</span> + c);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param4: &quot;</span> + d);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">a</span>(a,b,c,d);</span><br><span class="line">&#125;</span><br><span class="line">v.<span class="property">a</span>.<span class="title function_">overload</span>().<span class="property">implementation</span>= <span class="keyword">function</span> (<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param0&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">a</span>();</span><br><span class="line">&#125;</span><br><span class="line">v.<span class="property">a</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span>= <span class="keyword">function</span> (<span class="params">a,b</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param1: &quot;</span> + a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param2: &quot;</span> + b);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">a</span>(a,b);</span><br><span class="line">&#125;</span><br><span class="line">v.<span class="property">a</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;com.alibaba.fastjson.JSONObject&#x27;</span>, <span class="string">&#x27;long&#x27;</span>).<span class="property">implementation</span>= <span class="keyword">function</span> (<span class="params">a,b,c</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param1: &quot;</span> + a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param2: &quot;</span> + b);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;param3: &quot;</span> + c);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">a</span>(a,b,c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后发现四个参数的没被调用，所以走的是三个参数的流程，也就是下边的else的逻辑(这里不太明白，按照if的isLogin()判断感觉应该走上边的逻辑才对)</p>
<p>接着分析发现，在<code>C6485v.m79778</code>中又进入了<code>m8007a</code>函数，而该函数是一个标准的md5，所以只需要分析出参数就行了。</p>
<p>md5参数由字符串拼接组成，其中第一个<code>jSONObject.toString()</code>的值是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;params&quot;</span>:&#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;17860581502&quot;</span>&#125;&#125;   </span><br></pre></td></tr></table></figure>

<p>而str和j分别是前边的随机数和时间戳：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">replaceAll</span> <span class="operator">=</span> UUID.randomUUID().toString().replaceAll(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="type">long</span> <span class="variable">currentTimeMillis</span> <span class="operator">=</span> System.currentTimeMillis();</span><br></pre></td></tr></table></figure>

<p>所以只需分析<code>m7979a()</code>即可。</p>
<p><code>m7979a()</code>里又调用了<code>m7976a()</code>，然后再调用了<code>C6420af.m8129a</code>，而该函数是把参数字符串拼接后逆序。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* renamed from: a */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">m8129a</span><span class="params">(String str, String str2)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(str + str2).reverse().toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以我们只需要得到两个字符串常量<code>C6420af.m8127b((int) C3357R.string.forum_key)</code>和<code>C6420af.m8127b((int) C3357R.string.upload_key)</code>即可。这俩个参数直接通过hook获得，或者在<code>res/values/strings.xml</code>中直接查找（后一种仅支持字符串未加密的，若加密需要hook获得）。</p>
<p>得到</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">forum_key = <span class="string">&quot;94ac5cfb69e87bd7&quot;</span></span><br><span class="line">upload_key = <span class="string">&quot;860f50db3569e448&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="2、登录协议复现"><a href="#2、登录协议复现" class="headerlink" title="2、登录协议复现"></a>2、登录协议复现</h3><p>分析完成后，就可以复现协议了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">forum_key = <span class="string">&#x27;94ac5cfb69e87bd7&#x27;</span></span><br><span class="line">upload_key = <span class="string">&#x27;860f50db3569e448&#x27;</span></span><br><span class="line">timestamp = <span class="built_in">str</span>(<span class="built_in">int</span>(time.time() * <span class="number">1000</span>))</span><br><span class="line">phone = <span class="string">&quot;17860581502&quot;</span>       <span class="comment">#只需修改phone和password</span></span><br><span class="line">password = <span class="string">&quot;123456&quot;</span></span><br><span class="line">random_string = <span class="built_in">str</span>(uuid.uuid4()).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">md5_param = <span class="string">&#x27;&#123;&quot;params&quot;:&#123;&quot;password&quot;:&quot;&#x27;</span> + password +  <span class="string">&#x27;&quot;,&quot;username&quot;:&quot;&#x27;</span> + phone +  <span class="string">&#x27;&quot;&#125;&#125;&#x27;</span> + random_string + (forum_key + upload_key)[::-<span class="number">1</span>] + timestamp</span><br><span class="line"><span class="built_in">print</span>(md5_param)</span><br><span class="line">codeSign = hashlib.md5(md5_param.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest().upper()</span><br><span class="line"><span class="built_in">print</span>(codeSign)</span><br><span class="line">url = <span class="string">&quot;http://cbrx.qianfanapi.com/v2_2/user/login&quot;</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;nonce=&quot;</span> + random_string + <span class="string">&quot;&amp;codeSign=&quot;</span> + codeSign + <span class="string">&quot;&amp;timestamp=&quot;</span> + timestamp +  <span class="string">&quot;&amp;data=%7B%22params%22%3A%7B%22password%22%3A%22123456%22%2C%22username%22%3A%2217860581502%22%7D%7D&amp;version=2.2.1&amp;product_version=220&amp;platform=marlin&amp;network=1&amp;device=000000000000000&amp;access_token=c3890a98d08168702f924d92282e1014&amp;screen_width=1440&amp;screen_height=2392&amp;bbsnopic=0&amp;system=2&amp;system_version=29&amp;theme=4&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;QianFan;quan0715;Android;Mozilla/5.0;AppleWebkit/533.1;PixelXLgoogle29;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Length&quot;</span>: <span class="string">&quot;415&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;cbrx.qianfanapi.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;Keep-Alive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url=url, data=data, headers=headers)</span><br><span class="line">recv = r.text</span><br><span class="line"><span class="built_in">print</span>(recv)</span><br></pre></td></tr></table></figure>

<h3 id="3、算法自吐"><a href="#3、算法自吐" class="headerlink" title="3、算法自吐"></a>3、算法自吐</h3><p>因为是标准md5，同样直接出。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Utf8</span>: &#123;<span class="string">&quot;params&quot;</span>:&#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;17860581502&quot;</span>&#125;&#125;60cf8a291f414eba8c725bbabfa8a65b844e9653bd05f0687db78e96bfc5ca491740729987243</span><br><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Hex</span>: 7b22706172616d73223a7b2270617373776f7264223a22313233343536222c22757365726e616d65223a223137383630353831353032227d7d3630636638613239316634313465626138633732356262616266613861363562383434653936353362643035663036383764623738653936626663356361343931373430373239393837323433</span><br><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Base64</span>: eyJwYXJhbXMiOnsicGFzc3dvcmQiOiIxMjM0NTYiLCJ1c2VybmFtZSI6IjE3ODYwNTgxNTAyIn19NjBjZjhhMjkxZjQxNGViYThjNzI1YmJhYmZhOGE2NWI4NDRlOTY1M2JkMDVmMDY4N2RiNzhlOTZiZmM1Y2E0OTE3NDA3Mjk5ODcyNDM=</span><br><span class="line">=======================================================</span><br><span class="line"><span class="title class_">MessageDigest</span>.<span class="title function_">digest</span>() is called!</span><br><span class="line">java.<span class="property">lang</span>.<span class="property">Throwable</span></span><br><span class="line">	at java.<span class="property">security</span>.<span class="property">MessageDigest</span>.<span class="title function_">digest</span>(<span class="title class_">Native</span> <span class="title class_">Method</span>)</span><br><span class="line">	at java.<span class="property">security</span>.<span class="property">MessageDigest</span>.<span class="title function_">digest</span>(<span class="title class_">MessageDigest</span>.<span class="property">java</span>:<span class="number">448</span>)</span><br><span class="line">	at java.<span class="property">security</span>.<span class="property">MessageDigest</span>.<span class="title function_">digest</span>(<span class="title class_">Native</span> <span class="title class_">Method</span>)</span><br><span class="line">	at com.<span class="property">quan0715</span>.<span class="property">forum</span>.<span class="property">util</span>.<span class="property">r</span>.<span class="title function_">a</span>(<span class="title class_">TbsSdkJava</span>:<span class="number">41</span>)</span><br><span class="line">	at com.<span class="property">quan0715</span>.<span class="property">forum</span>.<span class="property">util</span>.<span class="property">v</span>.<span class="title function_">a</span>(<span class="title class_">TbsSdkJava</span>:<span class="number">30</span>)</span><br><span class="line">	at com.<span class="property">quan0715</span>.<span class="property">forum</span>.<span class="property">util</span>.<span class="property">v</span>.<span class="title function_">a</span>(<span class="title class_">Native</span> <span class="title class_">Method</span>)</span><br><span class="line">	at com.<span class="property">quan0715</span>.<span class="property">forum</span>.<span class="property">base</span>.<span class="property">b</span>.<span class="title function_">a</span>(<span class="title class_">TbsSdkJava</span>:<span class="number">68</span>)</span><br><span class="line">	at com.<span class="property">quan0715</span>.<span class="property">forum</span>.<span class="property">a</span>.<span class="property">f</span>.<span class="title function_">a</span>(<span class="title class_">TbsSdkJava</span>:<span class="number">38</span>)</span><br><span class="line">	at com.<span class="property">quan0715</span>.<span class="property">forum</span>.<span class="property">fragment</span>.<span class="property">login</span>.<span class="property">PasswordLoginFragment</span>.<span class="title function_">b</span>(<span class="title class_">TbsSdkJava</span>:<span class="number">424</span>)</span><br><span class="line">	at com.<span class="property">quan0715</span>.<span class="property">forum</span>.<span class="property">fragment</span>.<span class="property">login</span>.<span class="property">PasswordLoginFragment</span>.<span class="title function_">onClick</span>(<span class="title class_">TbsSdkJava</span>:<span class="number">347</span>)</span><br><span class="line">	at android.<span class="property">view</span>.<span class="property">View</span>.<span class="title function_">performClick</span>(<span class="title class_">View</span>.<span class="property">java</span>:<span class="number">7140</span>)</span><br><span class="line">	at android.<span class="property">view</span>.<span class="property">View</span>.<span class="title function_">performClickInternal</span>(<span class="title class_">View</span>.<span class="property">java</span>:<span class="number">7117</span>)</span><br><span class="line">	at android.<span class="property">view</span>.<span class="property">View</span>.<span class="title function_">access$3500</span>(<span class="title class_">View</span>.<span class="property">java</span>:<span class="number">801</span>)</span><br><span class="line">	at android.<span class="property">view</span>.<span class="property">View$PerformClick</span>.<span class="title function_">run</span>(<span class="title class_">View</span>.<span class="property">java</span>:<span class="number">27351</span>)</span><br><span class="line">	at android.<span class="property">os</span>.<span class="property">Handler</span>.<span class="title function_">handleCallback</span>(<span class="title class_">Handler</span>.<span class="property">java</span>:<span class="number">883</span>)</span><br><span class="line">	at android.<span class="property">os</span>.<span class="property">Handler</span>.<span class="title function_">dispatchMessage</span>(<span class="title class_">Handler</span>.<span class="property">java</span>:<span class="number">100</span>)</span><br><span class="line">	at android.<span class="property">os</span>.<span class="property">Looper</span>.<span class="title function_">loop</span>(<span class="title class_">Looper</span>.<span class="property">java</span>:<span class="number">214</span>)</span><br><span class="line">	at android.<span class="property">app</span>.<span class="property">ActivityThread</span>.<span class="title function_">main</span>(<span class="title class_">ActivityThread</span>.<span class="property">java</span>:<span class="number">7356</span>)</span><br><span class="line">	at java.<span class="property">lang</span>.<span class="property">reflect</span>.<span class="property">Method</span>.<span class="title function_">invoke</span>(<span class="title class_">Native</span> <span class="title class_">Method</span>)</span><br><span class="line">	at com.<span class="property">android</span>.<span class="property">internal</span>.<span class="property">os</span>.<span class="property">RuntimeInit$MethodAndArgsCaller</span>.<span class="title function_">run</span>(<span class="title class_">RuntimeInit</span>.<span class="property">java</span>:<span class="number">492</span>)</span><br><span class="line">	at com.<span class="property">android</span>.<span class="property">internal</span>.<span class="property">os</span>.<span class="property">ZygoteInit</span>.<span class="title function_">main</span>(<span class="title class_">ZygoteInit</span>.<span class="property">java</span>:<span class="number">930</span>)</span><br><span class="line"></span><br><span class="line"><span class="title class_">MD5</span> digest result <span class="title class_">Hex</span>: 700011ab119b7942dcfaf9f96b512c76</span><br><span class="line"><span class="title class_">MD5</span> digest result <span class="title class_">Base64</span>: cAARqxGbeULc+vn5a1Esdg==</span><br></pre></td></tr></table></figure>

<p>因为174往后是时间戳，所以接着搜索<code>60cf8a291f414eba8c725bbabfa8a65b</code>得知是hook的第一个str，最后剩个<code>844e9653bd05f0687db78e96bfc5ca49</code>因为是逆序，测试一下那两个key就行了。</p>
<h2 id="三、小红书"><a href="#三、小红书" class="headerlink" title="三、小红书"></a>三、小红书</h2><h3 id="1、登陆逆向"><a href="#1、登陆逆向" class="headerlink" title="1、登陆逆向"></a>1、登陆逆向</h3><p>同样没有抓包检测，httpcanary抓到如下登录请求包：</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE8hB5V"><img src="https://s21.ax1x.com/2025/03/01/pE8hB5V.png" alt="pE8hB5V.png" style="zoom:67%;" /></a></p>
<p>发现其中未知的有<code>password</code>和<code>sign</code>，其余的<code>android_id、deviceId</code>经测试都是固定的，<code>device_fingerprint</code>也是固定的，应该是当前的年月日(测试发现应该是第一次运行的时间，第一次运行后可能会生成一个对设备的标记)后拼接一个固定字符串，<code>t</code>是时间戳。</p>
<h3 id="2、加密密码"><a href="#2、加密密码" class="headerlink" title="2、加密密码"></a>2、加密密码</h3><p><code>password</code>比较简单，用自吐算法直接跑出来是md5，并且参数就是输入的明文：<code>123456</code>,所以<code>password</code>就是直接对密码进行一次md5。</p>
<h3 id="3、加密sign"><a href="#3、加密sign" class="headerlink" title="3、加密sign"></a>3、加密sign</h3><p>同样是md5，自吐算法搜索到如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Utf8</span>: f383e68a30a2ef440fb4b6359099798b475f4daa-8c7e-<span class="number">3969</span>-a14c-275bcfb795ff</span><br><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Hex</span>: 663338336536386133306132656634343066623462363335393039393739386234373566346461612d386337652d333936392d613134632d323735626366623739356666</span><br><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Base64</span>: <span class="title class_">ZjM4M2U2OGEzMGEyZWY0NDBmYjRiNjM1OTA5OTc5OGI0NzVmNGRhYS04YzdlLTM5NjktYTE0Yy0</span>yNzViY2ZiNzk1ZmY=</span><br><span class="line">=======================================================</span><br><span class="line"><span class="title class_">MessageDigest</span>.<span class="title function_">digest</span>() is called!</span><br><span class="line">java.<span class="property">lang</span>.<span class="property">Throwable</span></span><br><span class="line">	at java.<span class="property">security</span>.<span class="property">MessageDigest</span>.<span class="title function_">digest</span>(<span class="title class_">Native</span> <span class="title class_">Method</span>)</span><br><span class="line">	at com.<span class="property">xingin</span>.<span class="property">common</span>.<span class="property">util</span>.<span class="property">MD5Util</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">29</span>)</span><br><span class="line">	at com.<span class="property">xingin</span>.<span class="property">common</span>.<span class="property">util</span>.<span class="property">MD5Util</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">15</span>)</span><br><span class="line">	at com.<span class="property">xingin</span>.<span class="property">skynet</span>.<span class="property">XYValueRewrite</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">124</span>)</span><br><span class="line">	at com.<span class="property">xingin</span>.<span class="property">skynet</span>.<span class="property">XYValueRewrite</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">91</span>)</span><br><span class="line">	at retrofit2.<span class="property">RequestBuilder</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">216</span>)</span><br><span class="line">	at retrofit2.<span class="property">ServiceMethod</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">114</span>)</span><br><span class="line">	at retrofit2.<span class="property">OkHttpCall</span>.<span class="title function_">f</span>(<span class="title class_">SourceFile</span>:<span class="number">178</span>)</span><br><span class="line">	at retrofit2.<span class="property">OkHttpCall</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">162</span>)</span><br><span class="line">	at retrofit2.<span class="property">adapter</span>.<span class="property">rxjava</span>.<span class="property">CallOnSubscribe</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">45</span>)</span><br><span class="line">	at retrofit2.<span class="property">adapter</span>.<span class="property">rxjava</span>.<span class="property">CallOnSubscribe</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">29</span>)</span><br><span class="line">	at retrofit2.<span class="property">adapter</span>.<span class="property">rxjava</span>.<span class="property">BodyOnSubscribe</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">33</span>)</span><br><span class="line">	at retrofit2.<span class="property">adapter</span>.<span class="property">rxjava</span>.<span class="property">BodyOnSubscribe</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">25</span>)</span><br><span class="line">	at rx.<span class="property">Observable</span>.<span class="title function_">unsafeSubscribe</span>(<span class="title class_">SourceFile</span>:<span class="number">10144</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">48</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">33</span>)</span><br><span class="line">	at rx.<span class="property">Observable</span>.<span class="title function_">unsafeSubscribe</span>(<span class="title class_">SourceFile</span>:<span class="number">10144</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">48</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">33</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeLift</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">48</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeLift</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">30</span>)</span><br><span class="line">	at rx.<span class="property">Observable</span>.<span class="title function_">unsafeSubscribe</span>(<span class="title class_">SourceFile</span>:<span class="number">10144</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">48</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">33</span>)</span><br><span class="line">	at rx.<span class="property">Observable</span>.<span class="title function_">unsafeSubscribe</span>(<span class="title class_">SourceFile</span>:<span class="number">10144</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OperatorSubscribeOn$1</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">94</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">schedulers</span>.<span class="property">ScheduledAction</span>.<span class="title function_">run</span>(<span class="title class_">SourceFile</span>:<span class="number">55</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">schedulers</span>.<span class="property">ExecutorScheduler$ExecutorSchedulerWorker</span>.<span class="title function_">run</span>(<span class="title class_">SourceFile</span>:<span class="number">107</span>)</span><br><span class="line">	at java.<span class="property">util</span>.<span class="property">concurrent</span>.<span class="property">ThreadPoolExecutor</span>.<span class="title function_">runWorker</span>(<span class="title class_">ThreadPoolExecutor</span>.<span class="property">java</span>:<span class="number">1167</span>)</span><br><span class="line">	at java.<span class="property">util</span>.<span class="property">concurrent</span>.<span class="property">ThreadPoolExecutor$Worker</span>.<span class="title function_">run</span>(<span class="title class_">ThreadPoolExecutor</span>.<span class="property">java</span>:<span class="number">641</span>)</span><br><span class="line">	at java.<span class="property">lang</span>.<span class="property">Thread</span>.<span class="title function_">run</span>(<span class="title class_">Thread</span>.<span class="property">java</span>:<span class="number">919</span>)</span><br><span class="line"></span><br><span class="line"><span class="title class_">MD5</span> digest result <span class="title class_">Hex</span>: c205f9e983a7b47f44dd6ab2adac597c</span><br><span class="line"><span class="title class_">MD5</span> digest result <span class="title class_">Base64</span>: wgX56YOntH9E3WqyraxZfA==</span><br></pre></td></tr></table></figure>

<p>很明显了，参数是一串字符串<code>&quot;f383e68a30a2ef440fb4b6359099798b&quot;</code> 拼接上<code>device_id</code>的值。</p>
<p>接着搜索字符串<code>&quot;f383e68a30a2ef440fb4b6359099798b&quot;</code>找到如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Utf8</span>: <span class="number">85898120911356268927043326101501029864686733846908151086879131017411353641119430148383091909083112736821128726781162779159023757143952558085782181080798095841420848782772689486760011899480202270949118178737832910867862928313308568087794814848584918210874238487951281818629108638721101392857138220714410828385888978831863478127634997226822909275822830378458376868469187950861212748682080818484867510838193210927081661584178010530138483839061258422888665091221268301243489195928082778821175842521548690808467646936771156914911042372741694106712588919288211717728625524128718101139480</span></span><br><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Hex</span>: <span class="number">3835383938313230393131333536323638393237303433333236313031353031303239383634363836373333383436393038313531303836383739313331303137343131333533363431313139343330313438333833303931393039303833313132373336383231313238373236373831313632373739313539303233373537313433393532353538303835373832313831303830373938303935383431343230383438373832373732363839343836373630303131383939343830323032323730393439313138313738373337383332393130383637383632393238333133333038353638303837373934383134383438353834393138323130383734323338343837393531323831383138363239313038363338373231313031333932383537313338323230373134343130383238333835383838393738383331383633343738313237363334393937323236383232393039323735383232383330333738343538333736383638343639313837393530383631323132373438363832303830383138343834383637353130383338313933323130393237303831363631353834313738303130353330313338343833383339303631323538343232383838363635303931323231323638333031323433343839313935393238303832373738383231313735383432353231353438363930383038343637363436393336373731313536393134393131303432333732373431363934313036373132353838393139323838323131373137373238363235353234313238373138313031313339343830</span></span><br><span class="line"><span class="title class_">MD5</span> update data <span class="title class_">Base64</span>: <span class="title class_">ODU4OTgxMjA</span>5MTEzNTYyNjg5MjcwNDMzMjYxMDE1MDEwMjk4NjQ2ODY3MzM4NDY5MDgxNTEwODY4NzkxMzEwMTc0MTEzNTM2NDExMTk0MzAxNDgzODMwOTE5MDkwODMxMTI3MzY4MjExMjg3MjY3ODExNjI3NzkxNTkwMjM3NTcxNDM5NTI1NTgwODU3ODIxODEwODA3OTgwOTU4NDE0MjA4NDg3ODI3NzI2ODk0ODY3NjAwMTE4OTk0ODAyMDIyNzA5NDkxMTgxNzg3Mzc4MzI5MTA4Njc4NjI5MjgzMTMzMDg1NjgwODc3OTQ4MTQ4NDg1ODQ5MTgyMTA4NzQyMzg0ODc5NTEyODE4MTg2MjkxMDg2Mzg3MjExMDEzOTI4NTcxMzgyMjA3MTQ0MTA4MjgzODU4ODg5Nzg4MzE4NjM0NzgxMjc2MzQ5OTcyMjY4MjI5MDkyNzU4MjI4MzAzNzg0NTgzNzY4Njg0NjkxODc5NTA4NjEyMTI3NDg2ODIwODA4MTg0ODQ4Njc1MTA4MzgxOTMyMTA5MjcwODE2NjE1ODQxNzgwMTA1MzAxMzg0ODM4MzkwNjEyNTg0MjI4ODg2NjUwOTEyMjEyNjgzMDEyNDM0ODkxOTU5MjgwODI3Nzg4MjExNzU4NDI1MjE1NDg2OTA4MDg0Njc2NDY5MzY3NzExNTY5MTQ5MTEwNDIzNzI3NDE2OTQxMDY3MTI1ODg5MTkyODgyMTE3MTc3Mjg2MjU1MjQxMjg3MTgxMDExMzk0ODA=</span><br><span class="line">=======================================================</span><br><span class="line"><span class="title class_">MessageDigest</span>.<span class="title function_">digest</span>() is called!</span><br><span class="line">java.<span class="property">lang</span>.<span class="property">Throwable</span></span><br><span class="line">	at java.<span class="property">security</span>.<span class="property">MessageDigest</span>.<span class="title function_">digest</span>(<span class="title class_">Native</span> <span class="title class_">Method</span>)</span><br><span class="line">	at com.<span class="property">xingin</span>.<span class="property">common</span>.<span class="property">util</span>.<span class="property">MD5Util</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">29</span>)</span><br><span class="line">	at com.<span class="property">xingin</span>.<span class="property">common</span>.<span class="property">util</span>.<span class="property">MD5Util</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">15</span>)</span><br><span class="line">	at com.<span class="property">xingin</span>.<span class="property">skynet</span>.<span class="property">XYValueRewrite</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">124</span>)</span><br><span class="line">	at com.<span class="property">xingin</span>.<span class="property">skynet</span>.<span class="property">XYValueRewrite</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">91</span>)</span><br><span class="line">	at retrofit2.<span class="property">RequestBuilder</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">216</span>)</span><br><span class="line">	at retrofit2.<span class="property">ServiceMethod</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">114</span>)</span><br><span class="line">	at retrofit2.<span class="property">OkHttpCall</span>.<span class="title function_">f</span>(<span class="title class_">SourceFile</span>:<span class="number">178</span>)</span><br><span class="line">	at retrofit2.<span class="property">OkHttpCall</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">162</span>)</span><br><span class="line">	at retrofit2.<span class="property">adapter</span>.<span class="property">rxjava</span>.<span class="property">CallOnSubscribe</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">45</span>)</span><br><span class="line">	at retrofit2.<span class="property">adapter</span>.<span class="property">rxjava</span>.<span class="property">CallOnSubscribe</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">29</span>)</span><br><span class="line">	at retrofit2.<span class="property">adapter</span>.<span class="property">rxjava</span>.<span class="property">BodyOnSubscribe</span>.<span class="title function_">a</span>(<span class="title class_">SourceFile</span>:<span class="number">33</span>)</span><br><span class="line">	at retrofit2.<span class="property">adapter</span>.<span class="property">rxjava</span>.<span class="property">BodyOnSubscribe</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">25</span>)</span><br><span class="line">	at rx.<span class="property">Observable</span>.<span class="title function_">unsafeSubscribe</span>(<span class="title class_">SourceFile</span>:<span class="number">10144</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">48</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">33</span>)</span><br><span class="line">	at rx.<span class="property">Observable</span>.<span class="title function_">unsafeSubscribe</span>(<span class="title class_">SourceFile</span>:<span class="number">10144</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">48</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">33</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeLift</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">48</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeLift</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">30</span>)</span><br><span class="line">	at rx.<span class="property">Observable</span>.<span class="title function_">unsafeSubscribe</span>(<span class="title class_">SourceFile</span>:<span class="number">10144</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">48</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OnSubscribeMap</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">33</span>)</span><br><span class="line">	at rx.<span class="property">Observable</span>.<span class="title function_">unsafeSubscribe</span>(<span class="title class_">SourceFile</span>:<span class="number">10144</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">operators</span>.<span class="property">OperatorSubscribeOn$1</span>.<span class="title function_">call</span>(<span class="title class_">SourceFile</span>:<span class="number">94</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">schedulers</span>.<span class="property">ScheduledAction</span>.<span class="title function_">run</span>(<span class="title class_">SourceFile</span>:<span class="number">55</span>)</span><br><span class="line">	at rx.<span class="property">internal</span>.<span class="property">schedulers</span>.<span class="property">ExecutorScheduler$ExecutorSchedulerWorker</span>.<span class="title function_">run</span>(<span class="title class_">SourceFile</span>:<span class="number">107</span>)</span><br><span class="line">	at java.<span class="property">util</span>.<span class="property">concurrent</span>.<span class="property">ThreadPoolExecutor</span>.<span class="title function_">runWorker</span>(<span class="title class_">ThreadPoolExecutor</span>.<span class="property">java</span>:<span class="number">1167</span>)</span><br><span class="line">	at java.<span class="property">util</span>.<span class="property">concurrent</span>.<span class="property">ThreadPoolExecutor$Worker</span>.<span class="title function_">run</span>(<span class="title class_">ThreadPoolExecutor</span>.<span class="property">java</span>:<span class="number">641</span>)</span><br><span class="line">	at java.<span class="property">lang</span>.<span class="property">Thread</span>.<span class="title function_">run</span>(<span class="title class_">Thread</span>.<span class="property">java</span>:<span class="number">919</span>)</span><br><span class="line"></span><br><span class="line"><span class="title class_">MD5</span> digest result <span class="title class_">Hex</span>: f383e68a30a2ef440fb4b6359099798b</span><br><span class="line"><span class="title class_">MD5</span> digest result <span class="title class_">Base64</span>: 84PmijCi70QPtLY1kJl5iw==</span><br></pre></td></tr></table></figure>

<p>这时候参数不是明文字符串了，也看不出来是什么东西，我们就根据调用栈去静态分析。</p>
<p>jadx打开，定位到<code>com.xingin.skynet.XYValueRewrite.a</code>。</p>
<p>同样有两个重载函数。</p>
<p>三个参数函数：</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE8hwEq"><img src="https://s21.ax1x.com/2025/03/01/pE8hwEq.png" alt="pE8hwEq.png" style="zoom:80%;" /></a></p>
<p>一个参数函数：</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE8habn"><img src="https://s21.ax1x.com/2025/03/01/pE8habn.png" alt="pE8habn.png"></a></p>
<p>分析发现，sign的赋值语句在这一句。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list.<span class="title function_">add</span>(<span class="keyword">new</span> <span class="title class_">RequestParam</span>(<span class="string">&quot;sign&quot;</span>, <span class="title function_">m13042a</span>(hashMap), <span class="literal">false</span>, z2));</span><br></pre></td></tr></table></figure>

<p>所以是多个参数的函数那个将<code>hashMap</code>传入搭配一个参数的函数里。</p>
<p>我们直接hook一个参数的函数即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">XYValueRewrite</span>.<span class="property">a</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.util.Map&#x27;</span>).<span class="property">implementation</span>= <span class="keyword">function</span> (<span class="params">map</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Map没有toString方法，而HashMap中定义了toString方法，但是HashMap继承了Map，所以可以向下转换成HashMap</span></span><br><span class="line">    <span class="keyword">var</span> hashmap = <span class="title class_">Java</span>.<span class="title function_">cast</span>(map,<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.util.HashMap&quot;</span>))    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;XYValueRewrite.a param1: &quot;</span> + hashmap.<span class="title function_">toString</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">a</span>(map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">XYValueRewrite</span>.<span class="property">a</span> <span class="attr">param1</span>:  &#123;device_fingerprint=20250301154347d4b6f16629e3bbd7cb9850702542898501d6919591cc41ba, password=e10adc3949ba59abbe56e057f20f883e, t=<span class="number">1740814966</span>, zone=<span class="number">86</span>, phone=<span class="number">17860581502</span>, channel=<span class="title class_">Store360</span>, type=phone, lang=zh-<span class="variable constant_">CN</span>, android_id=7966307525d1c382, versionName=<span class="number">5.14</span><span class="number">.0</span>, deviceId=475f4daa-8c7e-<span class="number">3969</span>-a14c-275bcfb795ff, platform=<span class="title class_">Android</span>&#125;</span><br></pre></td></tr></table></figure>

<p>所以，多参数的函数做的处理就是将请求头中的一些信息放到一个HashMap集合里。</p>
<p>之后，继续分析一个参数的函数，发现return的时候调用了两次<code>m15461a</code>进行两次md5，正好对应我们自吐的结果，所以<code>sb2.toString()</code>应该就是我们上边搜索到的参数<code>85898120</code>开头的那一串。</p>
<p>所以，分析sb2，发现sb2是由bArr和bytes数组异或得到，而bytes是<code>divece_id</code>,bArr是<code> URLEncoder.m15386a</code>函数的返回值，那么我们hook一下这个函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">URLEncoder</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.xingin.common.util.URLEncoder&quot;</span>);</span><br><span class="line"><span class="title class_">URLEncoder</span>.<span class="property">a</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str1,str2</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;URLEncoder.a param1: &quot;</span> + str1);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;URLEncoder.a param2: &quot;</span> + str2);</span><br><span class="line">    <span class="keyword">var</span> res = <span class="variable language_">this</span>.<span class="title function_">a</span>(str1,str2);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;URLEncoder res:&quot;</span> + res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">URLEncoder</span>.<span class="property">a</span> <span class="attr">param1</span>: android_id=7966307525d1c382channel=<span class="title class_">Store360</span>deviceId=475f4daa-8c7e-<span class="number">3969</span>-a14c-275bcfb795ffdevice_fingerprint=20250301154347d4b6f16629e3bbd7cb9850702542898501d6919591cc41balang=zh-<span class="title class_">CNpassword</span>=e10adc3949ba59abbe56e057f20f883ephone=17860581502platform=<span class="title class_">Androidt</span>=1740814966type=phoneversionName=<span class="number">5.14</span>.0zone=<span class="number">86</span></span><br><span class="line"><span class="title class_">URLEncoder</span>.<span class="property">a</span> <span class="attr">param2</span>: <span class="variable constant_">UTF</span>-<span class="number">8</span></span><br><span class="line"><span class="title class_">URLEncoder</span> <span class="attr">res</span>:android_id%3D7966307525d1c382channel%3DStore360deviceId%3D475f4daa-8c7e-<span class="number">3969</span>-a14c-275bcfb795ffdevice_fingerprint%3D20250301154347d4b6f16629e3bbd7cb9850702542898501d6919591cc41balang%3Dzh-<span class="title class_">CNpassword</span>%3De10adc3949ba59abbe56e057f20f883ephone%3D17860581502platform%3DAndroidt%3D1740814966type%3DphoneversionName%3D5<span class="number">.14</span>.0zone%3D86</span><br></pre></td></tr></table></figure>

<p>发现参数和返回值只有&#x3D;变成了%3D,所以就是单纯做了URL encode（这个函数之前还对请求头Map做了排序处理）。</p>
<p>最后，我们写异或脚本测试一下：</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE8h0U0"><img src="https://s21.ax1x.com/2025/03/01/pE8h0U0.png" alt="pE8h0U0.png" style="zoom:150%;" /></a></p>
<p>结果一致，搞定！</p>
<h3 id="4、算法总结"><a href="#4、算法总结" class="headerlink" title="4、算法总结"></a>4、算法总结</h3><p>两个未知。</p>
<p><code>password</code>是由输入的密码直接md5得到。</p>
<p><code>sign</code>是由请求头中的信息经过排序后进行URL encode得到一个bytes数组，然后对bytes数组和<code>device_id</code>进行异或处理，再对异或的结果进行md5得到sign1,对sign1拼接<code>device_id</code>后再次进行md5得到sign(转小写)。</p>
<h3 id="5、登录协议复现"><a href="#5、登录协议复现" class="headerlink" title="5、登录协议复现"></a>5、登录协议复现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">timestamp = <span class="built_in">str</span>(<span class="built_in">int</span>(time.time() * <span class="number">1000</span>))</span><br><span class="line">phone = <span class="string">&quot;17860581502&quot;</span>     </span><br><span class="line">password = <span class="string">&quot;123456&quot;</span></span><br><span class="line">s1 = <span class="string">&quot;android_id%3D7966307525d1c382channel%3DStore360deviceId%3D475f4daa-8c7e-3969-a14c-275bcfb795ffdevice_fingerprint%3D20250301154347d4b6f16629e3bbd7cb9850702542898501d6919591cc41balang%3Dzh-CNpassword%3De10adc3949ba59abbe56e057f20f883ephone%3D17860581502platform%3DAndroidt%3D&quot;</span> + timestamp + <span class="string">&quot;type%3DphoneversionName%3D5.14.0zone%3D86&quot;</span></span><br><span class="line">s1Arr = <span class="built_in">bytes</span>(s1.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">s2 = <span class="string">&quot;475f4daa-8c7e-3969-a14c-275bcfb795ff&quot;</span></span><br><span class="line">s2str = <span class="built_in">bytes</span>(s2.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">list</span> = []</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> s1Arr:</span><br><span class="line">    <span class="built_in">list</span>.append(<span class="built_in">str</span>(j ^ s2str[i]))</span><br><span class="line">    i = (i + <span class="number">1</span>) % <span class="built_in">len</span>(s2str)</span><br><span class="line"></span><br><span class="line">md5_param1 = <span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>)</span><br><span class="line">md5_sign1 = hashlib.md5(md5_param1.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">md5_param2 = md5_sign1 + <span class="string">&quot;475f4daa-8c7e-3969-a14c-275bcfb795ff&quot;</span></span><br><span class="line">md5_sign2 = hashlib.md5(md5_param2.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://www.xiaohongshu.com/api/sns/v2/user/login&quot;</span></span><br><span class="line">data = <span class="string">&quot;password=&quot;</span> + hashlib.md5(password.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest() + <span class="string">&quot;&amp;zone=86&amp;phone=&quot;</span> + phone + <span class="string">&quot;&#x27;&amp;type=phone&amp;lang=zh&amp;android_id=7966307525d1c382&amp;platform=Android&amp;deviceId=475f4daa-8c7e-3969-a14c-275bcfb795ff&amp;device_fingerprint=20250301154347d4b6f16629e3bbd7cb9850702542898501d6919591cc41ba&amp;versionName=5.14.0&amp;channel=Store360&amp;lang=zh-CN&amp;t=&quot;</span> + timestamp + <span class="string">&quot;&amp;sign=&quot;</span> + md5_sign2</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 10; Pixel XL Build/QP1A.191005.007.A3) Resolution/1440*2392 Version/5.14.0 Build/5140002 Device/(Google;Pixel XL)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content-length&quot;</span>: <span class="string">&quot;357&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;www.xiaohongshu.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;accept-encoding&quot;</span>: <span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url=url, data=data, headers=headers)</span><br><span class="line">recv = r.text</span><br><span class="line"><span class="built_in">print</span>(recv)</span><br></pre></td></tr></table></figure>

<p>输出如下（404是因为app太老了，估计服务器已经不用了）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;timestamp&quot;</span>:<span class="number">1740883031348</span>,<span class="string">&quot;status&quot;</span>:<span class="number">404</span>,<span class="string">&quot;error&quot;</span>:<span class="string">&quot;Not Found&quot;</span>,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;No message available&quot;</span>,<span class="string">&quot;path&quot;</span>:<span class="string">&quot;/api/sns/v2/user/login&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pE8z6k8"><img src="https://s21.ax1x.com/2025/03/02/pE8z6k8.png" alt="pE8z6k8.png" style="zoom:67%;" /></a></p>
<p>与抓包的响应信息一致。</p>
<h3 id="6、验证码登录、注册分析"><a href="#6、验证码登录、注册分析" class="headerlink" title="6、验证码登录、注册分析"></a>6、验证码登录、注册分析</h3><p>验证码登录分为两步，发送验证码和验证码登录(由于服务器不可用，所以收不到验证码没法测试验证码登录功能)</p>
<p>不过可以测试发送验证码。</p>
<p>发送验证码算法逻辑同密码登录逻辑，也是两次md5，不过再对请求头put的时候少了<code>passsword</code>和<code>android_id</code>,如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">XYValueRewrite</span>.<span class="property">a</span> <span class="attr">param1</span>: &#123;device_fingerprint=20250301154347d4b6f16629e3bbd7cb9850702542898501d6919591cc41ba, t=<span class="number">1740882238</span>, zone=<span class="number">86</span>, phone=<span class="number">17860581502</span>, channel=<span class="title class_">Store360</span>, type=login, versionName=<span class="number">5.14</span><span class="number">.0</span>, lang=zh-<span class="variable constant_">CN</span>, deviceId=475f4daa-8c7e-<span class="number">3969</span>-a14c-275bcfb795ff, platform=<span class="title class_">Android</span>&#125;</span><br></pre></td></tr></table></figure>

<p>注册一样，也是发送验证码和验证码注册。</p>
<p>发送验证码算法逻辑同登录的发送验证码一样，只需修改其中的<code>type=register</code>。</p>
<h2 id="四、站酷"><a href="#四、站酷" class="headerlink" title="四、站酷"></a>四、站酷</h2><h3 id="1、登陆逆向-1"><a href="#1、登陆逆向-1" class="headerlink" title="1、登陆逆向"></a>1、登陆逆向</h3><p>同样没有抓包检测和frida检测，httpcanary抓到登录请求包如下：</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pEGhcOH"><img src="https://s21.ax1x.com/2025/03/03/pEGhcOH.png" alt="pEGhcOH.png" style="zoom:67%;" /></a></p>
<p>发现其中存在%3D，对应’&#x3D;’,猜测是base64解密，换成’&#x3D;’号尝试base64解码。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pEGhylD"><img src="https://s21.ax1x.com/2025/03/03/pEGhylD.png" alt="pEGhylD.png"></a></p>
<p>base64解码后，发现是另一串字符串拼接了<code>?keyId=1</code>。对前边的字符串再次尝试base64解码，发现失败，所以前边这一串应该不是base64编码了。</p>
<h3 id="2、代码定位"><a href="#2、代码定位" class="headerlink" title="2、代码定位"></a>2、代码定位</h3><p>字符串未加密，用jadx打开搜索<code>keyId</code>找到两处。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pEGhDfK"><img src="https://s21.ax1x.com/2025/03/03/pEGhDfK.png" alt="pEGhDfK.png"></a></p>
<p>这两处代码是一样的，随便找一个定位到<code>encrypt</code>函数中:</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pEGh66e"><img src="https://s21.ax1x.com/2025/03/03/pEGh66e.png" alt="pEGh66e.png" style="zoom:80%;" /></a></p>
<p>其中，<code>DESedeCoder.encode</code>是标准的DES加密，并且是ECB模式，key是<code>F#C@5IOBULR9L415C~ZX*97C</code>，直接hook该函数获取DES的明文。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">DESedeCoder</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zcool.base.encrypt.DESedeCoder&quot;</span>);</span><br><span class="line"><span class="title class_">DESedeCoder</span>.<span class="property">encode</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str1,str2</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DESedeCoder.encode param1: &quot;</span> + str1);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DESedeCoder.encode param2: &quot;</span> + str2);</span><br><span class="line">    <span class="keyword">var</span> res = <span class="variable language_">this</span>.<span class="title function_">encode</span>(str1,str2);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DeSedeCoder.encode res: &quot;</span> + res);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">DESedeCoder</span>.<span class="property">encode</span> <span class="attr">param1</span>: &#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span>,<span class="string">&quot;appLogin&quot;</span>:<span class="string">&quot;http://www.zcool.com.cn/tologin.do&quot;</span>,<span class="string">&quot;service&quot;</span>:<span class="string">&quot;http://www.zcool.com.cn&quot;</span>,<span class="string">&quot;appId&quot;</span>:<span class="string">&quot;1006&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;17860581502&quot;</span>&#125;</span><br><span class="line"><span class="title class_">DESedeCoder</span>.<span class="property">encode</span> <span class="attr">param2</span>: F#C@5IOBULR9L415C~<span class="variable constant_">ZX</span>*97C</span><br><span class="line"><span class="title class_">DeSedeCoder</span>.<span class="property">encode</span> <span class="attr">res</span>: u7e2kFB6HBN94Cwu23jgUqggAd8q162p4qWY0ktuYn36xSegjFFR0hBx7hfmzOeygf2G9IOMrL7Dsv4N/i4c6JsbXzGAFS8HBQs8GlvSpoiWs3yieUJcAOXRLI9lxHnDhPmT07H+<span class="regexp">/xEGT5UFiB0bAyfOEu2B38z6wsJvDa98f8AmzKuYnR/</span>4bZRU0sFNX0yhYhGhURLKaqo=</span><br></pre></td></tr></table></figure>

<p>可用看到加密结果就是我们base64解码后的数据。</p>
<p>所以这个算法的加密逻辑就是先DES加密拼接上<code>?keyId=1</code>再base64加密。</p>
<h3 id="3、登陆协议复现"><a href="#3、登陆协议复现" class="headerlink" title="3、登陆协议复现"></a>3、登陆协议复现</h3><p>这个题本来复现的话是需要在python里进行算法转发来调用frida，通过frida将DES加密的结果传给python之后base64加密再进行发包。</p>
<p>因为java里用的key是经过封装的key：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DESedeKeySpec</span> <span class="variable">dks</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DESedeKeySpec</span>(key);</span><br><span class="line"><span class="type">SecretKeyFactory</span> <span class="variable">keyFactory</span> <span class="operator">=</span> SecretKeyFactory.getInstance(<span class="string">&quot;DESede&quot;</span>);</span><br><span class="line"><span class="type">SecretKey</span> <span class="variable">secretKey</span> <span class="operator">=</span> keyFactory.generateSecret(dks);</span><br></pre></td></tr></table></figure>

<p>DES要求key是8个字节，但是明文key是24个字节，所以该封装可能对key做了一些操作，在python里没法用Crypto.Cipher.DES进行模拟。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># frida js主动调用代码</span></span><br><span class="line">jsCode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">function hookTest(phone,password)&#123;</span></span><br><span class="line"><span class="string">	var result;</span></span><br><span class="line"><span class="string">	Java.perform(function()&#123;</span></span><br><span class="line"><span class="string">		var DESedeCoder = Java.use(&quot;com.zcool.base.encrypt.DESedeCoder&quot;);</span></span><br><span class="line"><span class="string">		var str1 = &#x27;&#123;&quot;password&quot;:&quot;&#x27; + password + &#x27;&quot;,&quot;appLogin&quot;:&quot;http://www.zcool.com.cn/tologin.do&quot;,&quot;service&quot;:&quot;http://www.zcool.com.cn&quot;,&quot;appId&quot;:&quot;1006&quot;,&quot;username&quot;:&quot;&#x27; + phone + &#x27;&quot;&#125;&#x27;</span></span><br><span class="line"><span class="string">		var str2 = &quot;F#C@5IOBULR9L415C~ZX*97C&quot;</span></span><br><span class="line"><span class="string">        result = DESedeCoder.encode(str1,str2);</span></span><br><span class="line"><span class="string">        console.log(result)</span></span><br><span class="line"><span class="string">	&#125;);</span></span><br><span class="line"><span class="string">	return result;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">rpc.exports = &#123;</span></span><br><span class="line"><span class="string">	hooktest : hookTest	     //这里进行导出供python接收</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用frida转发脚本</span></span><br><span class="line">process = frida.get_device_manager().add_remote_device(<span class="string">&#x27;10.169.1.60:27042&#x27;</span>).attach(<span class="string">&quot;com.zcool.community&quot;</span>)</span><br><span class="line">script = process.create_script(jsCode)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">phone = <span class="string">&quot;17860581502&quot;</span></span><br><span class="line">password = <span class="string">&quot;123456&quot;</span></span><br><span class="line"><span class="comment"># 接收js的导出</span></span><br><span class="line">DES_data = script.exports.hooktest(phone, password)</span><br><span class="line">base64_param = DES_data + <span class="string">&quot;?keyId=1&quot;</span></span><br><span class="line">data = <span class="string">&quot;key=&quot;</span> + base64.b64encode(base64_param.encode(<span class="string">&#x27;utf-8&#x27;</span>)).decode() .replace(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;%3D&#x27;</span>) + <span class="string">&quot;&amp;app=android&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://passport.zcool.com.cn/login_jsonp_active.do&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded; charset=utf-8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Length&quot;</span>: <span class="string">&quot;302&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;passport.zcool.com.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;Keep-Alive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Cookie&quot;</span>: <span class="string">&quot;HWWAFSESID=51aca76a89015a09bf; HWWAFSESTIME=1740987519360; JSESSIONID=F8E8EBA5E745948546D839FE3E93C399&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;okhttp/3.1.2&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url=url, data=data, headers=headers)</span><br><span class="line">recv = r.text</span><br><span class="line"><span class="built_in">print</span>(recv)</span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">null(&#123;<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;账号未注册&quot;</span>,<span class="string">&quot;result&quot;</span>:false,<span class="string">&quot;code&quot;</span>:<span class="string">&quot;ACCOUNT.IS.NOT.EXIST&quot;</span>,<span class="string">&quot;success&quot;</span>:false,<span class="string">&quot;isUname&quot;</span>:false&#125;)</span><br></pre></td></tr></table></figure>

<p>与抓包的响应体信息一致。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pEGhsSO"><img src="https://s21.ax1x.com/2025/03/03/pEGhsSO.png" alt="pEGhsSO.png" style="zoom:67%;" /></a></p>
<h3 id="4、算法自吐-1"><a href="#4、算法自吐-1" class="headerlink" title="4、算法自吐"></a>4、算法自吐</h3><p>这题也可以用算法自吐，不过base64出不来，因为它不是用的标准base64库，而是自己实现了一个同样功能的base64加密类。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://bailan2.github.io">摆烂小子</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://bailan2.github.io/2025/02/27/Android-%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95app%E7%9A%84%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91/">https://bailan2.github.io/2025/02/27/Android-%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95app%E7%9A%84%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/./img/android.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/title.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">摆烂小子</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://mail.qq.com/" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95app%E7%9A%84%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91"><span class="toc-number">1.</span> <span class="toc-text">几个简单app的登录逆向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BB%8A%E6%97%A5%E9%95%87%E6%B1%9F"><span class="toc-number">1.1.</span> <span class="toc-text">一、今日镇江</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%8D%87%E7%BA%A7%E5%BC%B9%E7%AA%97%E5%8E%BB%E9%99%A4"><span class="toc-number">1.1.1.</span> <span class="toc-text">1、升级弹窗去除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91"><span class="toc-number">1.1.2.</span> <span class="toc-text">2、登录逆向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%99%BB%E5%BD%95%E5%8D%8F%E8%AE%AE%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.1.3.</span> <span class="toc-text">3、登录协议复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E7%AE%97%E6%B3%95%E8%87%AA%E5%90%90"><span class="toc-number">1.1.4.</span> <span class="toc-text">4、算法自吐</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%810715%E5%9C%88"><span class="toc-number">1.2.</span> <span class="toc-text">二、0715圈</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91"><span class="toc-number">1.2.1.</span> <span class="toc-text">1、登录逆向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E7%99%BB%E5%BD%95%E5%8D%8F%E8%AE%AE%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.2.2.</span> <span class="toc-text">2、登录协议复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%AE%97%E6%B3%95%E8%87%AA%E5%90%90"><span class="toc-number">1.2.3.</span> <span class="toc-text">3、算法自吐</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%B0%8F%E7%BA%A2%E4%B9%A6"><span class="toc-number">1.3.</span> <span class="toc-text">三、小红书</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%99%BB%E9%99%86%E9%80%86%E5%90%91"><span class="toc-number">1.3.1.</span> <span class="toc-text">1、登陆逆向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%8A%A0%E5%AF%86%E5%AF%86%E7%A0%81"><span class="toc-number">1.3.2.</span> <span class="toc-text">2、加密密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%8A%A0%E5%AF%86sign"><span class="toc-number">1.3.3.</span> <span class="toc-text">3、加密sign</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-number">1.3.4.</span> <span class="toc-text">4、算法总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E7%99%BB%E5%BD%95%E5%8D%8F%E8%AE%AE%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.3.5.</span> <span class="toc-text">5、登录协议复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E9%AA%8C%E8%AF%81%E7%A0%81%E7%99%BB%E5%BD%95%E3%80%81%E6%B3%A8%E5%86%8C%E5%88%86%E6%9E%90"><span class="toc-number">1.3.6.</span> <span class="toc-text">6、验证码登录、注册分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%AB%99%E9%85%B7"><span class="toc-number">1.4.</span> <span class="toc-text">四、站酷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%99%BB%E9%99%86%E9%80%86%E5%90%91-1"><span class="toc-number">1.4.1.</span> <span class="toc-text">1、登陆逆向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%BB%A3%E7%A0%81%E5%AE%9A%E4%BD%8D"><span class="toc-number">1.4.2.</span> <span class="toc-text">2、代码定位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%99%BB%E9%99%86%E5%8D%8F%E8%AE%AE%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.4.3.</span> <span class="toc-text">3、登陆协议复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E7%AE%97%E6%B3%95%E8%87%AA%E5%90%90-1"><span class="toc-number">1.4.4.</span> <span class="toc-text">4、算法自吐</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/02/27/Android-%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95app%E7%9A%84%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91/" title="Android-几个简单app的登录逆向"><img src="/./img/android.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android-几个简单app的登录逆向"/></a><div class="content"><a class="title" href="/2025/02/27/Android-%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95app%E7%9A%84%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91/" title="Android-几个简单app的登录逆向">Android-几个简单app的登录逆向</a><time datetime="2025-02-27T06:39:49.000Z" title="Created 2025-02-27 14:39:49">2025-02-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/11/Android-frida_root%E6%A3%80%E6%B5%8B/" title="Android-frida_root检测"><img src="/./img/android.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android-frida_root检测"/></a><div class="content"><a class="title" href="/2025/02/11/Android-frida_root%E6%A3%80%E6%B5%8B/" title="Android-frida_root检测">Android-frida_root检测</a><time datetime="2025-02-11T03:44:17.000Z" title="Created 2025-02-11 11:44:17">2025-02-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/10/Android-H5app%E9%80%86%E5%90%91%E6%80%BB%E7%BB%93/" title="Android-H5app逆向总结"><img src="/./img/android.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android-H5app逆向总结"/></a><div class="content"><a class="title" href="/2025/02/10/Android-H5app%E9%80%86%E5%90%91%E6%80%BB%E7%BB%93/" title="Android-H5app逆向总结">Android-H5app逆向总结</a><time datetime="2025-02-10T07:38:41.000Z" title="Created 2025-02-10 15:38:41">2025-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/26/Android-%E5%AF%86%E7%A0%81%E5%AD%A6%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/" title="Android-密码学数字签名"><img src="/./img/android.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android-密码学数字签名"/></a><div class="content"><a class="title" href="/2025/01/26/Android-%E5%AF%86%E7%A0%81%E5%AD%A6%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/" title="Android-密码学数字签名">Android-密码学数字签名</a><time datetime="2025-01-26T03:14:48.000Z" title="Created 2025-01-26 11:14:48">2025-01-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/14/Pwn-%E9%AB%98%E8%B4%A8%E9%87%8F%E6%AF%94%E8%B5%9B%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B05-2024%E5%BC%BA%E7%BD%91%E6%9D%AFS8%E7%BA%BF%E4%B8%8A%E5%88%9D%E8%B5%9B/" title="Pwn-高质量比赛题目复现5-2024强网杯S8线上初赛"><img src="/./img/pwn.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Pwn-高质量比赛题目复现5-2024强网杯S8线上初赛"/></a><div class="content"><a class="title" href="/2024/12/14/Pwn-%E9%AB%98%E8%B4%A8%E9%87%8F%E6%AF%94%E8%B5%9B%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B05-2024%E5%BC%BA%E7%BD%91%E6%9D%AFS8%E7%BA%BF%E4%B8%8A%E5%88%9D%E8%B5%9B/" title="Pwn-高质量比赛题目复现5-2024强网杯S8线上初赛">Pwn-高质量比赛题目复现5-2024强网杯S8线上初赛</a><time datetime="2024-12-14T08:56:33.000Z" title="Created 2024-12-14 16:56:33">2024-12-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/./img/android.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By 摆烂小子</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">簡</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://bailan2.github.io/2025/02/27/Android-%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95app%E7%9A%84%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91/'
    this.page.identifier = '2025/02/27/Android-几个简单app的登录逆向/'
    this.page.title = 'Android-几个简单app的登录逆向'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><div class="aplayer no-destroy" data-id="7399261759" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>